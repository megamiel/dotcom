<div class="sentence" id="kaisetsu">まず、副問合せの部分から考えていきます。<br/><div class="pre">SELECT AVG (販売単価 - 仕入単価) FROM 商品</div>このSQL文は、"商品"表の各行について販売単価から仕入単価を差し引いた値（粗利益）を求め、その平均値を返すものです。全商品の粗利益の平均値は、<br/><br/>　(200＋200＋100＋900＋400＋200＋300＋500＋500＋300)÷10＝360<br/><br/>なので、副問合せは360という単一値を返します。<br/><br/>副問合せの結果をSQL文に代入すると以下のようになります。<br/><div class="pre">SELECT DISTINCT 仕入先コード FROM 商品<br/>　WHERE (販売単価 - 仕入単価) &gt; 360</div>主問合せ側のWHERE句では、"商品"表の行のうち粗利益（販売単価－仕入単価）が全商品の平均粗利益である360を上回る行が選択されます。粗利益が360より大きいのは、商品D、商品E、商品H、商品Iの4つです。<div class="img_margin"><img alt="28_1.gif" src="https://www.ap-siken.com/kakomon/04_aki/img/28_1.gif"/></div>この4行から成る中間表から、仕入先コード列が抽出されます。このとき、DISTINCTがあるので重複する行は1つにまとめられます。<div class="img_margin"><img alt="28_2.gif" src="https://www.ap-siken.com/kakomon/04_aki/img/28_2.gif"/></div>したがって、結果表に含まれる仕入先コード数は「3つ」となります。</div>